(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[939],{7846:function(e,t,n){!function(){"use strict";var t=n(6086),r=n(5181),s={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",preflightContinue:!1,optionsSuccessStatus:204};function o(e){return"string"==typeof e||e instanceof String}function i(e,t){var n=t.headers.origin,r=[];return e.origin&&"*"!==e.origin?(o(e.origin)?r.push([{key:"Access-Control-Allow-Origin",value:e.origin}]):r.push([{key:"Access-Control-Allow-Origin",value:!!function e(t,n){if(Array.isArray(n)){for(var r=0;r<n.length;++r)if(e(t,n[r]))return!0;return!1}return o(n)?t===n:n instanceof RegExp?n.test(t):!!n}(n,e.origin)&&n}]),r.push([{key:"Vary",value:"Origin"}])):r.push([{key:"Access-Control-Allow-Origin",value:"*"}]),r}function a(e){return!0===e.credentials?{key:"Access-Control-Allow-Credentials",value:"true"}:null}function l(e){var t=e.exposedHeaders;return t&&(t.join&&(t=t.join(",")),t&&t.length)?{key:"Access-Control-Expose-Headers",value:t}:null}function u(e,t){for(var n=0,s=e.length;n<s;n++){var o=e[n];o&&(Array.isArray(o)?u(o,t):"Vary"===o.key&&o.value?r(t,o.value):o.value&&t.setHeader(o.key,o.value))}}e.exports=function(e){var n=null;return n="function"==typeof e?e:function(t,n){n(null,e)},function(e,r,o){n(e,function(n,d){if(n)o(n);else{var c=t({},s,d),f=null;c.origin&&"function"==typeof c.origin?f=c.origin:c.origin&&(f=function(e,t){t(null,c.origin)}),f?f(e.headers.origin,function(t,n){var s,d,f,h,p,g,v,m,w;t||!n?o(t):(c.origin=n,s=c,d=e,f=r,h=o,w=[],"OPTIONS"===(d.method&&d.method.toUpperCase&&d.method.toUpperCase())?(w.push(i(s,d)),w.push(a(s,d)),w.push(((p=s.methods).join&&(p=s.methods.join(",")),{key:"Access-Control-Allow-Methods",value:p})),w.push((g=s.allowedHeaders||s.headers,v=[],g?g.join&&(g=g.join(",")):(g=d.headers["access-control-request-headers"],v.push([{key:"Vary",value:"Access-Control-Request-Headers"}])),g&&g.length&&v.push([{key:"Access-Control-Allow-Headers",value:g}]),v)),w.push((m=("number"==typeof s.maxAge||s.maxAge)&&s.maxAge.toString())&&m.length?{key:"Access-Control-Max-Age",value:m}:null),w.push(l(s,d)),u(w,f),s.preflightContinue?h():(f.statusCode=s.optionsSuccessStatus,f.setHeader("Content-Length","0"),f.end())):(w.push(i(s,d)),w.push(a(s,d)),w.push(l(s,d)),u(w,f),h()))}):o()}})}}}()},6086:function(e){"use strict";var t=Object.assign.bind(Object);e.exports=t,e.exports.default=e.exports},9402:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(2729),s=n(5893),o=n(3434);n(7294);var i=n(964);function a(){let e=(0,r._)(['\n  background: #890044;\n  font-family: "Onest", sans-serif;\n  font-optical-sizing: auto;\n  font-style: normal;\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  justify-content: center;\n  align-items: center;\n']);return a=function(){return e},e}function l(){let e=(0,r._)(["\n  color: #fff;\n  font-size: 28px;\n  line-height: 40px;\n  letter-spacing: -2%;\n  font-weight: 600;\n"]);return l=function(){return e},e}function u(){let e=(0,r._)(["\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  color: #fff;\n  font-size: 15px;\n  text-align: center;\n  line-height: 22px;\n  font-weight: 400;\n"]);return u=function(){return e},e}let d=i.ZP.section(a()),c=i.ZP.section(l()),f=i.ZP.section(u());var h=()=>(0,s.jsxs)(d,{children:[(0,s.jsx)("img",{style:{width:"100%"},src:"https://artha-one-assets.s3.ap-south-1.amazonaws.com/failure.svg",alt:"Some error with the flow"}),(0,s.jsx)(c,{children:"Something went wrong"}),(0,s.jsxs)(f,{children:[(0,s.jsx)("div",{children:"Don’t worry, we’ll figure it out."}),(0,s.jsx)("div",{children:"Let’s retry to continue the journey."})]})]}),p=n(6487);function g(){let e=(0,r._)(["\n  text-align: center;\n"]);return g=function(){return e},e}function v(){let e=(0,r._)(['\n  padding: 40px 0;\n  background: #fff;\n  font-family: "Arvo", serif;\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n']);return v=function(){return e},e}let m=i.ZP.div(g()),w=i.ZP.section(v()),y=e=>{let{status:t,errorCode:n}=e,r="https://loop-niti-assets.s3.ap-south-1.amazonaws.com/page+not+found.svg";return t&&(r=p.l[t]),console.log({status:t,imageUrl:r,errorCode:n}),(0,s.jsx)(m,{children:(0,s.jsx)(w,{children:(0,s.jsx)("div",{className:"container",children:(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-sm-12 ",children:(0,s.jsx)("div",{className:"col-sm-10 col-sm-offset-1  text-center",children:(0,s.jsx)("img",{src:r,alt:"Some error with the flow",width:"300"})})})})})})})};var x=e=>{let t,{accessKey:n,errorCode:r,status:i=500}=e;try{t=(0,o.aj)(n).tenantId}catch(e){t="niti.ai"}return"arthaone.in"===t?(0,s.jsx)(h,{}):(0,s.jsx)(y,{status:i,errorCode:r})}},8939:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(5893),s=n(7294),o=n(3434),i=n(4562),a=n(9402),l=n(2773),u=n(5740),d=n(7632);n(7846);let c=(e,t)=>{let{inputParams:n}=e,{action:r,...s}=t,{flowId:o,campaignKey:i,sessionId:a,podId:l,redirectUrl:u,nodeId:d,...c}=s;return{...c,...n}};var f=n(2893),h=n(4456);n(2043);let p=async function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,d=f.MS,c=f.fi,{nodeID:p,flowId:g}=e,v=(0,o.fG)(e,t,n,r,l),m=(0,h.S)(s,i,a),w=(0,h.l)(),y=0;try{let e=performance.now(),n=await m.post(d,v),r=performance.now();y=n.status;let i=n.data.data,a=n.data.error;if(200===y&&(i=n.data),200!==y||null===i)throw Error(JSON.stringify({error:a,status:y}));if("FLOW_ENDED"===i.message&&"success"===i.status)return{data:{html:"",js:"",params:""},error:null,status:200};let l=(0,o.zX)(i.Params),f={html:i.HTML,js:l+i.JS,params:i.Params,startTime:e,endTime:r,status:y,parentId:i.NodeParentID,nodeName:i.NodeName,podId:i.Params.podId,overlay:i.Overlay};return w.post(c,{flowId:i.Params.flowId,userId:t,nodeId:null!=p?p:"1",nodeName:null!=u?u:"Node 1",apiCall:"ExecuteFlow",responseTime:r-e,responseStatusCode:y,accessKey:s,eventType:"API"}),w.post(c,{flowId:i.Params.flowId,userId:t,nodeId:null!=p?p:"1",nodeName:null!=u?u:"Node 1",nodeParentId:i.NodeParentID,accessKey:s,eventType:"OPEN"}),{data:f,error:null,status:200}}catch(e){if(e){let{message:t,code:n,description:r}=JSON.parse(e.message);return{error:{message:t||"Unknown Error",code:n||"ERROR_UNKNOWN",description:r||""},status:y}}return{error:{message:"Unknown Error",code:"ERROR_UNKNOWN"},status:y||500}}},g=()=>{window.SDK?window.SDK.postMessage(JSON.stringify({eventType:"loopEvent",eventName:"ON_FLOW_END",params:{param1:1,param2:2}})):window.parent.postMessage(JSON.stringify({eventType:"loopEvent",eventName:"ON_FLOW_END",params:{param1:1,param2:2}}),"*")},v=()=>{var e,t,n;(null===(e=window.SDK)||void 0===e?void 0:e.dismiss)?null===(t=window.SDK)||void 0===t||t.dismiss():window.SDK&&(null===(n=window.SDK)||void 0===n||n.postMessage(JSON.stringify({eventType:"loopEvent",eventName:"ON_FLOW_DISMISS",params:{}})))},m=()=>{if(window.SDK){var e;null===(e=window.SDK)||void 0===e||e.postMessage(JSON.stringify({eventType:"loopEvent",eventName:"ON_FLOW_START",params:{}}))}else window.parent.postMessage(JSON.stringify({eventType:"loopEvent",eventName:"ON_FLOW_START",params:{}}),"*")},w=(e,t)=>(t.overlay?e[1]=t:(e.length=0,e[0]=t),e),y=e=>{let t=e.data;if("SDK"===t.mode){if("share"===t.event)void 0!==window.SDK&&window.SDK.share(t.content);else{let{mode:e,...n}=t;window.SDK&&window.SDK.postMessage(JSON.stringify(n))}}};var x=e=>{let{podId:t,userId:n,campaignId:f,campaignKey:h,userAuthToken:x,accessKey:S,params:j,mode:I,deviceType:N,dismissAllowed:O}=e,[E,A]=(0,s.useState)(!1),[P,D]=(0,s.useState)(),[k,C]=(0,s.useState)({}),[T,b]=(0,s.useState)({type:""}),[K,_]=(0,s.useState)(!1),[Z,H]=(0,s.useState)([]),[L,M]=(0,s.useState)(!1),[U,W]=(0,s.useState)(""),[R,F]=(0,s.useState)(),[J,z]=(0,s.useState)(""),[V,B]=(0,s.useState)(),X=(0,s.useRef)(k);(0,s.useEffect)(()=>{K&&window.close()},[K]),(0,s.useEffect)(()=>{n&&(f||h)&&q()},[n,f,h]),(0,s.useEffect)(()=>{(null==k?void 0:k.nodeID)&&G({...k,sessionId:J}),X.current=k},[k,n]),(0,s.useEffect)(()=>{if(window&&(0,o.gy)(window,t,C,b,(e,t)=>{let n={...e.inputParams,...t};C({...e,inputParams:n})},(e,t)=>{(0,u.Us)(e,{accessKey:S,userAuthToken:x,mode:I},()=>X.current).then(e=>t.window.postMessage({msg:"Hello",actionResponse:e},"*")).catch(e=>{t.window.postMessage({msg:"Hello",actionResponse:e},"*")})},{onExit:()=>{g(),B(c(k,{})),H(Z),_(!0),A(!1),window.close()}}),window.SDK)return window.addEventListener("message",y),()=>{window.removeEventListener("message",y)}},[]),(0,s.useEffect)(()=>{V&&(0,o.i6)(V)},[V]);let q=async()=>{let e=(0,d.Z)();z(e),await G({flowId:f,inputParams:j,campaignKey:h,sessionId:e}),(0,i.Dv)(null,n,S),m()},Y=()=>{_(!0),v()},G=async e=>{A(!0);try{var r;let s=null!==(r=null==P?void 0:P.params)&&void 0!==r?r:{};e.inputParams.sessionId=J;let{data:o,error:i,status:a}=await p(e,n,T.type,s,t,S,x,I,h,null==P?void 0:P.nodeName);if(F(a),200!==a){M(!0),A(!1),i?W(i.code):o||W("No Data");return}if(C(o.params),""===o.html){g(),B(c(e,s)),H(Z),_(!0),A(!1);return}t===o.podId&&(H(e=>w(e,o)),A(!1),D(o))}catch(e){A(!1),M(!0),W(U)}};return L?R&&(0,r.jsx)(a.Z,{status:R,accessKey:S}):(0,r.jsxs)("div",{style:{position:"relative"},children:[E&&(0,r.jsx)("div",{style:{position:"absolute",zIndex:"6",height:"100vh",width:"100vw",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(l.Z,{})}),(0,r.jsx)("div",{id:t,style:{zIndex:"3"},children:Z.map((e,n)=>(0,r.jsxs)("div",{id:"modal-overlay",style:{position:"fixed",width:"100%",height:"100%",zIndex:"5",display:"flex",alignItems:"center",minWidth:"360px",justifyContent:"center"},children:[(0,r.jsx)("div",{id:"modal-container",style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",minWidth:"300px",maxWidth:N&&"mobile"==N?"450px":"720px"},children:(0,r.jsx)("iframe",{id:"non-starter-nodes",srcDoc:(0,o.eh)("<body>".concat(e.html,"</body>"),e.js,S,x,I),title:"Embedded Loop Flows",width:"100%",height:"100%",style:{border:"none"}})}),window.SDK&&O?(0,r.jsx)("button",{id:"close-modal",style:{position:"absolute",zIndex:"1",top:"10px",right:"10px",cursor:"pointer",opacity:"0.5"},onClick:Y,children:(0,r.jsx)("span",{style:{fontWeight:"bold"},children:"x"})}):(0,r.jsx)(r.Fragment,{})]},"".concat(t,"-overlay-").concat(n)))})]})}},4562:function(e,t,n){"use strict";n.d(t,{Dv:function(){return o}});var r=n(7632),s=n(340);n(1833);let o=(e,t,n)=>{var r;null==e||null===(r=e.nodeDetails)||void 0===r||r.map(e=>{let r=Object.keys(e)[0],{nodeName:s,parentId:o}=Object.values(e)[0];i({flowId:r,nodeID:"1"},t,s,o,n)})},i=(e,t,n,o,i)=>{let{flowId:a,nodeID:l}=e,u={eventId:(0,r.Z)(),timestamp:String(Math.floor(Date.now()/1e3)),eventType:"Opened",source:"web-sdk",flowId:String(a),userId:t,nodeId:String(l),nodeParentId:String(o),nodeName:n,accessKey:i};try{(0,s.i$)({event:{schema:"iglu:com.nitiai/raw_events_public/jsonschema/1-0-0",data:u}})}catch(e){console.error("Tracking Call Error: ",e)}}},4456:function(e,t,n){"use strict";n.d(t,{S:function(){return s},l:function(){return o}});var r=n(5121);let s=(e,t,n)=>{let s=r.Z.create(),o=null,i=null;return s.interceptors.request.use(async r=>("SDK"===n?(o=o="Bearer "+e,i=t):(o="Bearer "+(o=JSON.parse(localStorage.getItem("accessKey"))),i="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI5YjY5Njk1MS04Zjk1LTQ5ZDItYWVhZS04ZDU4OGVkYmI2YTkifQ.B4X06Me4F3QU6JnxIaUm1i7RrilTP7jEZm-M2BrOo-YrTXQBLoDg7B7Gh2W444ePt87fp8V3BthdL0ofOPB2nuYSOv2wfyd8F_cR51PZ1eYLgXvxEUTW1cB7rFZoeRUjVPQHvw5qMxXObss4K9yf-VaDBfJUQ5yLu6rc9qlqzsMSun_ZiuYeuFQU9IxufJkIADsHUVnELNEWvMZLodUhPOQ_XnHm6WpHgdXvwbkuO3f5RlqV3vnRXXHZ3S7LF4O5garsz6KTk7CGUaz6sTGIK0Hf9KtFiodormGFxbVU7EAzpCCoQxl7Ieyi5wwMY33-j1Pc_1PKrOBuBkNtTFYeGw"),r.headers={...r.headers,accessKey:o},r.headers.userAuthToken||(r.headers={...r.headers,accessKey:o,userAuthToken:"Bearer ".concat(i)}),r.headers={...r.headers,"X-Requested-With":n},r)),s.interceptors.response.use(e=>e,e=>(console.error(e),e.response||e)),s},o=()=>{let e=r.Z.create();return e.interceptors.response.use(e=>e,e=>(console.error(e),e.response||e)),e}},5740:function(e,t,n){"use strict";n.d(t,{Mi:function(){return a},Us:function(){return u},sm:function(){return l}}),n(4562);var r=n(3434),s=n(4456),o=n(1833),i=n(2893);let a=(e,t,n,a,l)=>{let u=i.HG+"?userId=".concat(e,"&podId=").concat(t),d=(0,s.S)(n,a,l);return new Promise((e,n)=>{d.get(u).then(n=>{var s,o;let i=n.data,a=(0,r.zX)(i.Params);e({html:i.HTML,js:'const podId = "'.concat(t,'"; ')+a+i.JS,params:i.Params,flows:i.NumberOfFlows||0,nodeDetails:i.NodeDetails,podHeight:null==i?void 0:null===(s=i.PodConfig)||void 0===s?void 0:s.height,podWidth:null==i?void 0:null===(o=i.PodConfig)||void 0===o?void 0:o.width})}).catch(e=>{o.Z.error("renderPod error",e),n({error:e})})})},l=async(e,t,n,r)=>{let a=i.fy+"/".concat(e),l=(0,s.S)(t,n,r);return new Promise((e,t)=>{l.get(a).then(t=>{e(t.data)}).catch(e=>{o.Z.error("getConfigurations error",e),t({error:e})})})},u=(e,t,n)=>{let{accessKey:o,userAuthToken:a,mode:l}=t,u=n();e.inputParams={...e.inputParams,...u};let d=i.Zs,c=(0,r.hr)(e);return new Promise((e,t)=>{(0,s.S)(o,a,l).post(d,c).then(n=>{let r=null==n?void 0:n.data,s="success";200!==n.status&&t({executeActionStatus:s="failed",error:r}),e({executeActionStatus:s,...r})}).catch(e=>{e instanceof Error?console.error("An error occurred:",e.message):console.error("An unknown error occurred:",e),t({executeActionStatus:"failed",error:e})})})}},5181:function(e){"use strict";/*!
 * vary
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */e.exports=function(e,t){if(!e||!e.getHeader||!e.setHeader)throw TypeError("res argument is required");var r=e.getHeader("Vary")||"";(r=n(Array.isArray(r)?r.join(", "):String(r),t))&&e.setHeader("Vary",r)},e.exports.append=n;var t=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function n(e,n){if("string"!=typeof e)throw TypeError("header argument is required");if(!n)throw TypeError("field argument is required");for(var s=Array.isArray(n)?n:r(String(n)),o=0;o<s.length;o++)if(!t.test(s[o]))throw TypeError("field argument contains an invalid header name");if("*"===e)return e;var i=e,a=r(e.toLowerCase());if(-1!==s.indexOf("*")||-1!==a.indexOf("*"))return"*";for(var l=0;l<s.length;l++){var u=s[l].toLowerCase();-1===a.indexOf(u)&&(a.push(u),i=i?i+", "+s[l]:s[l])}return i}function r(e){for(var t=0,n=[],r=0,s=0,o=e.length;s<o;s++)switch(e.charCodeAt(s)){case 32:r===t&&(r=t=s+1);break;case 44:n.push(e.substring(r,t)),r=t=s+1;break;default:t=s+1}return n.push(e.substring(r,t)),n}}}]);